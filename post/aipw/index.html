<!DOCTYPE html><html lang="en-us" >

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.1.0 for Hugo" />
  

  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="In this tutorial, we are going to see how to robustly estimate treatment effects when treatment is conditionally randomly assigned, using the Augmented Inverse Propensity Weighted estimator, also known as doubly-robust estimator." />

  
  <link rel="alternate" hreflang="en-us" href="https://matteocourthoud.github.io/post/aipw/" />

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    <meta name="theme-color" content="#003f5c" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">

    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Roboto+Mono&family=Source+Sans+Pro:wght@200;300;400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto+Mono&family=Source+Sans+Pro:wght@200;300;400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.0d2a901e9ec5ae65ee7e3341f63ecd04.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-144780600-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-144780600-1', { 'anonymize_ip': true });
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  

  

  




  
  
  

  

  
    <link rel="manifest" href="/index.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hu03e9b3967b83fd39296ec9da5ff1ea05_201175_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hu03e9b3967b83fd39296ec9da5ff1ea05_201175_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://matteocourthoud.github.io/post/aipw/" />

  
  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image" />
  
  <meta property="og:site_name" content="Matteo Courthoud" />
  <meta property="og:url" content="https://matteocourthoud.github.io/post/aipw/" />
  <meta property="og:title" content="AIPW | Matteo Courthoud" />
  <meta property="og:description" content="In this tutorial, we are going to see how to robustly estimate treatment effects when treatment is conditionally randomly assigned, using the Augmented Inverse Propensity Weighted estimator, also known as doubly-robust estimator." /><meta property="og:image" content="https://matteocourthoud.github.io/post/aipw/featured.png" />
    <meta property="twitter:image" content="https://matteocourthoud.github.io/post/aipw/featured.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2022-04-15T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2022-04-15T00:00:00&#43;00:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://matteocourthoud.github.io/post/aipw/"
  },
  "headline": "AIPW",
  
  "image": [
    "https://matteocourthoud.github.io/post/aipw/featured.png"
  ],
  
  "datePublished": "2022-04-15T00:00:00Z",
  "dateModified": "2022-04-15T00:00:00Z",
  
  "publisher": {
    "@type": "Organization",
    "name": "Matteo Courthoud",
    "logo": {
      "@type": "ImageObject",
      "url": "https://matteocourthoud.github.io/media/icon_hu03e9b3967b83fd39296ec9da5ff1ea05_201175_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "In this tutorial, we are going to see how to robustly estimate treatment effects when treatment is conditionally randomly assigned, using the Augmented Inverse Propensity Weighted estimator, also known as doubly-robust estimator."
}
</script>

  

  

  
  
  
  
  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.1/cookieconsent.min.js" integrity="sha256-5VhCqFam2Cn+yjw61zbBNrbHVJ6SRydPeKopYlngbiQ=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.1.1/cookieconsent.min.css" integrity="sha256-zQ0LblD/Af8vOppw18+2anxsuaz3pWYyVWi+bTvTH8Q=" crossorigin="anonymous">
  
  <script>
  window.addEventListener("load", function(){
    window.cookieconsent.initialise({
      "palette": {
        "popup": {
          "background": "#003f5c",
          "text": "rgb(255, 255, 255)"
        },
        "button": {
          "background": "rgb(255, 255, 255)",
          "text": "#003f5c"
        }
      },
      "theme": "classic",
      "content": {
        "message": "This website uses cookies to ensure you get the best experience on our website.",
        "dismiss": "Got it!",
        "link": "Learn more",
        "href": "/privacy/"
      }
    })});
  </script>


  





  <title>AIPW | Matteo Courthoud</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="bc7e85f56e381bf28f3ee62ab0bf1da0" >

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.a8a181ea67095ef9fbb0e99ffbf585a0.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Matteo Courthoud</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Matteo Courthoud</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Research</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Courses</span><span class="caret"></span>
          </a>
          <div class="dropdown-menu">
            
              <a class="dropdown-item" href="/course/ml-econ/"><span>Machine Learning for Economics</span></a>
            
              <a class="dropdown-item" href="/course/data-science/"><span>Data Science with Python</span></a>
            
              <a class="dropdown-item" href="/course/empirical-io/"><span>PhD Industrial Organization</span></a>
            
              <a class="dropdown-item" href="/course/metrics/"><span>PhD Econometrics</span></a>
            
              <a class="dropdown-item" href="https://pp4rs.github.io/"><span>Programming Practices for Research</span></a>
            
          </div>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/post/"><span>Posts</span></a>
        </li>

        
        

        

        
        
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/cv"><span>CV</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      

      
      

      
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <div class="container-fluid docs">
  <div class="row">

    <div class="col-xl-2 col-lg-2 d-none d-xl-block d-lg-block empty">
    </div>

    <div class="col-2 col-xl-2 col-lg-2 d-none d-lg-block docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#setting">Setting</a></li>
    <li><a href="#the-ipw-estimator">The IPW Estimator</a></li>
    <li><a href="#the-aipw-estimator">The AIPW Estimator</a>
      <ul>
        <li><a href="#double-robustness">Double Robustness</a></li>
      </ul>
    </li>
    <li><a href="#best-practices">Best Practices</a></li>
    <li><a href="#example">Example</a></li>
    <li><a href="#research-paper-replication">Research Paper Replication</a></li>
    <li><a href="#business-case">Business Case</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
    </div>

    <main class="col-xl-8 col-lg-8 docs-content" role="main">
        <article class="article">
        




















  


<div class="article-container pt-3">
  <h1>AIPW</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Apr 15, 2022
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    11 min read
  </span>
  

  
  
  
  
  
  

  
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 1237px; max-height: 742px;">
  <div style="position: relative">
    <img src="/post/aipw/featured.png" alt="" class="featured-image">
    
  </div>
</div>


        <div class="article-container">
          <div class="article-style" align="justify">
            <p>In this tutorial, we are going to see how to robustly estimate treatment effects when treatment is conditionally randomly assigned, using the <strong>Augmented Inverse Propensity Weighted</strong> estimator, also known as <strong>doubly-robust</strong> estimator.</p>
<p>For this tutorial, I assume you are familiar with the following concepts:</p>
<ul>
<li>Rubin&rsquo;s potential outcome framework</li>
<li>Propensity score weighting</li>
<li>Basic machine learning</li>
</ul>
<h2 id="setting">Setting</h2>
<p>We assume that for a set of i.i.d. subjects $i = 1, &hellip;, n$ we observed a tuple $(X_i, T_i, Y_i)$ comprised of</p>
<ul>
<li>a feature vector $X_i \in \mathbb R^n$</li>
<li>a treatment assignment $T_i \in \lbrace 0, 1 \rbrace$</li>
<li>a response $Y_i \in \mathbb R$</li>
</ul>
<p><strong>Assumption 1 : unconfoundedness</strong> (or ignorability, or selection on observables)</p>
<p>$$
\big \lbrace Y_i^{(1)} , Y_i^{(0)} \big \rbrace \ \perp \ T_i \ | \ X_i
$$</p>
<p>i.e. conditional on observable characteristics $X$, the treatment assignment $T$ is as good as random.</p>
<p><strong>Assumption 2: overlap</strong> (or bounded support)</p>
<p>$$
\exists \eta &gt; 0 \ : \ \eta \leq \mathbb E \left[ T_i = 1 \ \big | \ X_i = x \right] \leq 1-\eta
$$</p>
<p>i.e. no observation is deterministically assigned to the treatment or control group.</p>
<h2 id="the-ipw-estimator">The IPW Estimator</h2>
<p>We want to estimate the <strong>average treatment effect</strong></p>
<p>$$
\tau(x) = \mathbb E \left[ Y^{(1)} - Y^{(0)} \ \big| \ X = x \right]
$$</p>
<p>We would like to obtain an unbiased estimator that satifies a central limit theorem of the form</p>
<p>$$
\sqrt{n} ( \hat \tau - \tau) \ \overset{d}{\to} \ N(0, V)
$$</p>
<p>thus enabling us to construct <strong>confidence intervals</strong>.</p>
<p>Under <strong>unconfoundedness</strong>, we can rewrite the average treatment effect as</p>
<p>$$
\tau(x) = \mathbb E \left[ Y^{(1)} - Y^{(0)} \ \big| \ X = x \right] = \mathbb E \left[ \frac{T_i Y_i}{e(X_i)} - \frac{(1-T_i) Y_i}{1-e(X_i)} \right]
$$</p>
<p>where $e(X_i)$ is the <strong>propensity score</strong> of observation $i$,</p>
<p>$$
e(x) = \mathbb P \left[ T_i = 1 \ \big | \ X_i = x \right]
$$</p>
<p>i.e. its probability of being treated.</p>
<p>Note that this formulation of the average treatment effect does not depend on the potential outcomes $Y_i^{(1)}$ and $Y_i^{(0)}$, but only on the observed outcomes $Y_i$.</p>
<p>This formulation of the average treatment effect implies the <strong>Inverse Propensity Weighted</strong> estimator which is an unbiased estimator for the average treatment effect $\tau$</p>
<p>$$
\hat \tau^{*}_{IPW} = \frac{1}{n} \sum _ {i=1}^{n} \left( \frac{T_i Y_i}{e(X_i)} - \frac{(1-T_i) Y_i}{1-e(X_i)} \right)
$$</p>
<p>However, this estimator is <strong>unfeasible</strong> since we do not observe the propensity scores $e(X_i)$.</p>
<h2 id="the-aipw-estimator">The AIPW Estimator</h2>
<p>A feasible estimator of the average treatment effect $\tau$ is</p>
<p>$$
\hat \tau_{IPW} = \frac{1}{n} \sum_{i=1}^{n} \left( \frac{T_i Y_i}{\hat e(X_i)} - \frac{(1-T_i) Y_i}{1-\hat e(X_i)} \right)
$$</p>
<p>where we have replaced the propensity scores $e (X_i)$ with their estimates $\hat e (X_i)$.</p>
<p>With a linear model, $Y_i = \alpha T_i + \beta X_i + \varepsilon_i$, we can get a central limit theorem for $\hat \tau$. However, we want to take a non-parametric / <strong>machine learning</strong> approach with respect to the relationship between $Y$ and $X$.</p>
<p><strong>Advantages</strong></p>
<ul>
<li>flexible functional form for $\mathbb E[Y | X]$</li>
</ul>
<p><strong>Disadvantages</strong></p>
<ul>
<li>machine learning methods have slow convergence rates</li>
<li>it impacts inference, i.e. we cannot easily get a central limit theorem result to build confidence intervals</li>
</ul>
<p>Is there a way to get around the slow rate of convergence of machine learning methods?</p>
<p><strong>Yes!</strong> Idea: combine two predicton problems instead of one.</p>
<p>The <strong>Augmented Inverse Propensity Weighted</strong> estimator is given by</p>
<p>$$
\hat \tau_{IPW} = \frac{1}{n} \sum_{i=1}^{n} \left( \hat \mu^{(1)}(X_i) - \hat \mu^{(0)}(X_i) + \frac{T_i }{\hat e(X_i)} \left( Y_i - \hat \mu^{(1)}(X_i) \right) - \frac{(1-T_i) }{1-\hat e(X_i)} \left( Y_i - \hat \mu^{(0)}(X_i) \right) \right)
$$</p>
<p>where</p>
<p>$$
\mu^{(t)}(x) = \mathbb E \left[ Y_i \ \big | \ X_i = x, T_i = t \right] \qquad ; \qquad e(x) = \mathbb E \left[ T_i = 1 \ \big | \ X_i = x \right]
$$</p>
<p>The formula of the AIPW estimator might seem scary at first, so let&rsquo;s <strong>decompose</strong> it into two parts.</p>
<p>First,</p>
<p>$$
D = \frac{1}{n} \sum_{i=1}^{n} \left( \hat \mu^{(1)}(X_i) - \hat \mu^{(0)}(X_i) \right)
$$</p>
<p>is basically the <strong>direct estimate</strong> of the average treatment effect. This is a consistent estimator of the ATE but, since machine learning estimators' rate of convergence is too slow, it does not provide correct confidence intervals.</p>
<p>Instead,</p>
<p>$$
R = \frac{1}{n} \sum_{i=1}^{n} \left(\frac{T_i }{\hat e(X_i)} \left( Y_i - \hat \mu^{(1)}(X_i) \right) - \frac{(1-T_i) }{1-\hat e(X_i)} \left( Y_i - \hat \mu^{(0)}(X_i) \right) \right)
$$</p>
<p>is basically <strong>IPW applied to the residuals</strong> $Y_i - \hat \mu^{(t)}(X_i)$ instead of $Y_i$.</p>
<h3 id="double-robustness">Double Robustness</h3>
<p>Why is the AIPW estimator so <strong>compelling</strong>? It just needs one of the two predictions, $\hat \mu$ and $\hat e$, to be right in order to be unbiased. Let&rsquo;s check it.</p>
<p>If $\hat \mu$ is correctly specified, i.e. $\mathbb E \left[ \hat \mu^{(t)}(x) \right] = \mathbb E \left[ Y_i \ \big | \ X_i = x, T_i = t \right]$, then</p>
<p>$$
\begin{aligned}
\hat \tau_{IPW} &amp;\overset{p}{\to} \mathbb E \left[ \hat \mu^{(1)}(X_i) - \hat \mu^{(0)}(X_i) + \frac{T_i \left( Y_i - \hat \mu^{(1)}(X_i) \right)}{\hat e(X_i)} - \frac{(1-T_i) \left( Y_i - \hat \mu^{(0)}(X_i) \right)}{1-\hat e(X_i)} \right] =
\newline
&amp;= \mathbb E \left[ \hat \mu^{(1)}(X_i) - \hat \mu^{(0)}(X_i) \right] =
\newline
&amp;= \mathbb E \left[ Y^{(1)} - Y^{(0)} \right] =
\newline
&amp;= \tau
\end{aligned}
$$</p>
<p>even if $\hat e$ is misspecified.</p>
<p>The <strong>intuition</strong> is that the residuals $\left( Y_i - \hat \mu^{(t)}(X_i) \right)$ converge to zero and therefore IPW has no relevance.</p>
<p>On the other hand, if $\hat e$ is correctly specified, i.e. $\mathbb E \left[\hat e(x) \right] = \mathbb E \left[ T_i = 1 \ \big | \ X_i = x \right]$, then</p>
<p>$$
\begin{aligned}
\hat \tau_{IPW} &amp;\overset{p}{\to} \mathbb E \left[ \hat \mu^{(1)}(X_i) - \hat \mu^{(0)}(X_i) + \frac{T_i \left( Y_i - \hat \mu^{(1)}(X_i) \right)}{\hat e(X_i)} - \frac{(1-T_i) \left( Y_i - \hat \mu^{(0)}(X_i) \right)}{1-\hat e(X_i)} \right] =
\newline
&amp;= \mathbb E \left[ \frac{T_i Y_i}{\hat e(X_i)} - \frac{(1-T_i) Y_i }{1-\hat e(X_i)} + \left(1 - \frac{T_i}{\hat e(X_i)} \right) \hat \mu^{(1)}(X_i) - \left(1 - \frac{1-T_i}{1-\hat e(X_i)} \right) \hat \mu^{(0)}(X_i)  \right] =
\newline
&amp;= \mathbb E \left[ \frac{T_i Y_i}{\hat e(X_i)} - \frac{(1-T_i) Y_i }{1-\hat e(X_i)}\right] =
\newline
&amp;= \mathbb E \left[ Y^{(1)} - Y^{(0)} \right] =
\newline
&amp;= \tau
\end{aligned}
$$</p>
<p>even if $\hat \mu$ is misspecified.</p>
<p>The <strong>intuition</strong> is that, if we have a wrong model of $\mu(x)$ for $\mathbb E \left[ Y_i \ \big | \ X_i = x, T_i = t \right]$, it will not capture differences between treatment and control group or, even worse, it will capture wrong ones. Running IPW on the residuals we can not only recover the treatment effect but also compensate for eventual biases introduced by $\mu(x)$.</p>
<h2 id="best-practices">Best Practices</h2>
<p><strong>1. Check Covariate Balance</strong></p>
<p>Both IPW and AIPW were built for settings in which the treatment $T$ is not uconditionally randomly assigned, but might depend on some observables $X$. This information can be checked in two ways:</p>
<ol>
<li>Produce a balance table, summarizing the covariates across treatment arms. If undonditional randomization does not hold, we expect to see significant differences across some observables</li>
<li>Plot the estimated propensity scores. If undonditional randomization holds, we expect the propensity scores to be constant</li>
</ol>
<p><strong>2. Check the Overlap Assumption</strong></p>
<p>Another assumption that we can check is the <strong>overlap</strong> assumption, i.e. $\exists \eta \ : \ \eta \leq \mathbb E \left[ T_i = 1 \ \big | \ X_i = x \right] \leq 1-\eta$. To check this assumption we can simply check the bounds of the predicted propensity scores. If the overlap assumption is violated, we end up dividing some term of the estimator by zero.</p>
<p><strong>3. Use LOO Predictors</strong></p>
<p>It is best practice, whenever we build a prediction it is best pratice to exclude observation $i$ when fitting the algorithm for predicting $\hat \mu^{(t)} (X_i)$ or $\hat e (X_i)$. These predictors are called <strong>Leave One Out</strong> predictors.</p>
<h2 id="example">Example</h2>
<pre><code class="language-python">%matplotlib inline
%config InlineBackend.figure_format = 'retina'
</code></pre>
<pre><code class="language-python">from src.utils import *
from src.dgp import dgp_aipw
</code></pre>
<p>In this example, we are going to use the following <strong>data generating process</strong></p>
<ul>
<li>$N = 1000$</li>
<li>$p = 20$</li>
<li>$X_i \sim N(0, I_p)$</li>
<li>$e(x) = 1 / (1 + e^{-x_1})$</li>
<li>$\mu^{(0)}(x) = (x_1 + x_2)_+$</li>
<li>$\mu^{(1)}(x) = (x_1 + x_3)_+ \mathbf{- 0.05}$</li>
</ul>
<p>So that the average treatment effect is $- 0.05$.</p>
<pre><code class="language-python">dgp = dgp_aipw()
df = dgp.generate_data()
df.head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
      <th>x4</th>
      <th>x5</th>
      <th>x6</th>
      <th>x7</th>
      <th>x8</th>
      <th>x9</th>
      <th>x10</th>
      <th>...</th>
      <th>x16</th>
      <th>x17</th>
      <th>x18</th>
      <th>x19</th>
      <th>x20</th>
      <th>e</th>
      <th>T</th>
      <th>Y0</th>
      <th>Y1</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.624345</td>
      <td>-0.611756</td>
      <td>-0.528172</td>
      <td>-1.072969</td>
      <td>0.865408</td>
      <td>-2.301539</td>
      <td>1.744812</td>
      <td>-0.761207</td>
      <td>0.319039</td>
      <td>-0.249370</td>
      <td>...</td>
      <td>-1.099891</td>
      <td>-0.172428</td>
      <td>-0.877858</td>
      <td>0.042214</td>
      <td>0.582815</td>
      <td>0.835394</td>
      <td>1</td>
      <td>0.962589</td>
      <td>0.996174</td>
      <td>0.996174</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.100619</td>
      <td>1.144724</td>
      <td>0.901591</td>
      <td>0.502494</td>
      <td>0.900856</td>
      <td>-0.683728</td>
      <td>-0.122890</td>
      <td>-0.935769</td>
      <td>-0.267888</td>
      <td>0.530355</td>
      <td>...</td>
      <td>-0.012665</td>
      <td>-1.117310</td>
      <td>0.234416</td>
      <td>1.659802</td>
      <td>0.742044</td>
      <td>0.249624</td>
      <td>0</td>
      <td>0.044105</td>
      <td>-0.050000</td>
      <td>0.044105</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.191836</td>
      <td>-0.887629</td>
      <td>-0.747158</td>
      <td>1.692455</td>
      <td>0.050808</td>
      <td>-0.636996</td>
      <td>0.190915</td>
      <td>2.100255</td>
      <td>0.120159</td>
      <td>0.617203</td>
      <td>...</td>
      <td>0.586623</td>
      <td>0.838983</td>
      <td>0.931102</td>
      <td>0.285587</td>
      <td>0.885141</td>
      <td>0.452188</td>
      <td>1</td>
      <td>-0.050000</td>
      <td>-0.100000</td>
      <td>-0.100000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.754398</td>
      <td>1.252868</td>
      <td>0.512930</td>
      <td>-0.298093</td>
      <td>0.488518</td>
      <td>-0.075572</td>
      <td>1.131629</td>
      <td>1.519817</td>
      <td>2.185575</td>
      <td>-1.396496</td>
      <td>...</td>
      <td>-2.022201</td>
      <td>-0.306204</td>
      <td>0.827975</td>
      <td>0.230095</td>
      <td>0.762011</td>
      <td>0.319864</td>
      <td>1</td>
      <td>0.448470</td>
      <td>-0.100000</td>
      <td>-0.100000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.222328</td>
      <td>-0.200758</td>
      <td>0.186561</td>
      <td>0.410052</td>
      <td>0.198300</td>
      <td>0.119009</td>
      <td>-0.670662</td>
      <td>0.377564</td>
      <td>0.121821</td>
      <td>1.129484</td>
      <td>...</td>
      <td>0.077340</td>
      <td>-0.343854</td>
      <td>0.043597</td>
      <td>-0.620001</td>
      <td>0.698032</td>
      <td>0.444646</td>
      <td>0</td>
      <td>0.000000</td>
      <td>-0.050000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div>
<p>First, we check for covariate imbalance across treatment arms, with a <strong>balance table</strong>.</p>
<pre><code class="language-python">df.groupby('T').agg(['mean', 'std']).T.unstack(1).head()
</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead tr th {
    text-align: left;
}
</code></pre>
<p></style></p>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>T</th>
      <th colspan="2" halign="left">0</th>
      <th colspan="2" halign="left">1</th>
    </tr>
    <tr>
      <th></th>
      <th>mean</th>
      <th>std</th>
      <th>mean</th>
      <th>std</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x1</th>
      <td>-0.462644</td>
      <td>0.920626</td>
      <td>0.413837</td>
      <td>0.882116</td>
    </tr>
    <tr>
      <th>x2</th>
      <td>0.007900</td>
      <td>1.010610</td>
      <td>-0.054072</td>
      <td>0.991680</td>
    </tr>
    <tr>
      <th>x3</th>
      <td>-0.005718</td>
      <td>0.950997</td>
      <td>-0.042624</td>
      <td>1.059308</td>
    </tr>
    <tr>
      <th>x4</th>
      <td>0.122930</td>
      <td>0.936591</td>
      <td>0.095082</td>
      <td>1.004048</td>
    </tr>
    <tr>
      <th>x5</th>
      <td>0.032637</td>
      <td>0.955479</td>
      <td>0.119788</td>
      <td>1.039616</td>
    </tr>
  </tbody>
</table>
</div>
<p>We can also get a first (wrong) estimate of the treatment effect as a difference in means.</p>
<pre><code class="language-python">df.loc[df['T']==1, 'Y'].mean() - df.loc[df['T']==0, 'Y'].mean()
</code></pre>
<pre><code>0.29838749886286686
</code></pre>
<p>We know this estimate is wrong since the treatment is not unconditionally randomized. Therefore, we estimate the average treatment effect using the <strong>AIPW estimator</strong>.</p>
<p>First, we estimate the <strong>propensity scores</strong> $e(x)$ using <code>LogisticRegression</code>.</p>
<pre><code class="language-python">def estimate_e(df, X, model_e):
    e = model_e.fit(df[dgp.X], df['T']).predict_proba(df[dgp.X])[:,1]
    return e
</code></pre>
<pre><code class="language-python">from sklearn.linear_model import LogisticRegression as logit

e = estimate_e(df, dgp.X, logit())
</code></pre>
<p>A best practice is to use the <code>LeaveOneOut</code> estimator to make predictions, i.e., for each observations, build a model using the remaining observations. This procedure helps preventing overfitting bias. The main issue is that it&rsquo;s particularly slow since we need to fit one model per observation. However, it is parallelizable.</p>
<pre><code class="language-python">from sklearn.model_selection import cross_val_predict, LeaveOneOut

e = cross_val_predict(estimator=logit(), 
                      X=df[dgp.X], 
                      y=df['T'],
                      cv=LeaveOneOut(),
                      method='predict_proba',
                      n_jobs=-1)[:,1]
</code></pre>
<p>Let&rsquo;s check if the <strong>bounded support</strong> assumption is satisfied.</p>
<pre><code class="language-python">print(f'Support of e is [{min(e):.2}, {max(e):.2}]')
</code></pre>
<pre><code>Support of e is [0.019, 0.97]
</code></pre>
<p>The support assumption is satisfied. Note that this is guaranteed with logistic regression.</p>
<p>We can further plot the distribution of scores. They definitely do not seem constant.</p>
<pre><code class="language-python">sns.histplot(e, bins=100).set(title='Propensity Scores');
</code></pre>
<p><img src="img/aipw_29_0.png" alt="png"></p>
<p>We can now estimate the average treatment effect using the AIPW estimator. We also separately compute its components, $D$ and $R$.</p>
<p>We use <code>RandomForestRegressor</code> to estimate the conditional expectation of $Y$, $\hat \mu^{(t)}(x)$.</p>
<pre><code class="language-python">def estimate_mu(df, X, model_mu):
    mu = model_mu.fit(df[X + ['T']], df['Y'])
    mu0 = mu.predict(df[X + ['T']].assign(T=0))
    mu1 = mu.predict(df[X + ['T']].assign(T=1))
    return mu0, mu1
</code></pre>
<pre><code class="language-python">from sklearn.ensemble import RandomForestRegressor as rfr

mu0, mu1 = estimate_mu(df, dgp.X, rfr(max_features=5))
</code></pre>
<p>We now have all the elements to estimate AIPW</p>
<pre><code class="language-python">def AIPW(df, X, e, mu0, mu1):
    D = mu1 - mu0
    R = df['T'] / e * (df['Y'] - mu1) - (1-df['T']) / (1-e) * (df['Y'] - mu0)
    tau_AIPW = D + R
    return D, R, tau_AIPW
</code></pre>
<pre><code class="language-python">D, R, hat_tau_AIPW = AIPW(df, dgp.X, e, mu0, mu1)
print(f&quot;Mean: {np.mean(hat_tau_AIPW):.2} and var {np.var(hat_tau_AIPW):.2}&quot;)
</code></pre>
<pre><code>Mean: -0.02 and var 0.48
</code></pre>
<p>Our estimate is now closer to the true value, $-0.05$. We plot the distribution of $\hat \tau_i^{AIPW}$ below.</p>
<pre><code class="language-python">sns.histplot(hat_tau_AIPW, bins=20).set(title='Estimated $τ_{AIPW}$');
</code></pre>
<p><img src="img/aipw_37_0.png" alt="png"></p>
<p>To visualize the impact of the AIPW correction, we simulate the distribution of the AIPW estimator and its components.</p>
<pre><code class="language-python">def simulate_AIPW(k):
    df = dgp_aipw().generate_data(seed=k)
    e = estimate_e(df, dgp.X, logit())
    mu0, mu1 = estimate_mu(df, dgp.X, rfr())
    aipw = AIPW(df, dgp.X, e, mu0, mu1)
    return np.mean(aipw, axis=1)
</code></pre>
<pre><code class="language-python">from joblib import Parallel, delayed

def distribution_AIPW(t):
    r = Parallel(n_jobs=8)(delayed(simulate_AIPW)(i) for i in range(100))
    sim_tau_AIPW = pd.DataFrame(r, columns=['Direct', 'Correction', '$τ_{AIPW}$'])
    plot = sns.boxplot(data=pd.melt(sim_tau_AIPW), x='variable', y='value', linewidth=2);
    plot.set(title=t, xlabel='', ylabel='')
    plot.axhline(-0.05, c='r', ls=':');
</code></pre>
<p>Below we plot the AIPW estimator and its components.</p>
<pre><code class="language-python">distribution_AIPW(&quot;Distribution of $\hat τ_{AIPW}$ and its components&quot;)
</code></pre>
<p><img src="img/aipw_42_0.png" alt="png"></p>
<p>Since the model is well specified, the correction is close to zero and the final estimates are very close to the direct estimates.</p>
<p>We now turn into checking the <strong>double-robustness</strong> of the estimator.</p>
<p>What happens if we misspecify the propensity score? Let&rsquo;s assume now that the propensity score is $\hat e(X_i) = 1 /(1 + e^{x_4})$.</p>
<pre><code class="language-python">def estimate_e(df, X, model_e):
    e = 1 / (1 + np.exp(df['x4']))
    return e
</code></pre>
<pre><code class="language-python">distribution_AIPW(&quot;Distribution of $\hat τ_{AIPW}$ with misspecified $\hat e$&quot;)
</code></pre>
<p><img src="img/aipw_45_0.png" alt="png"></p>
<p>Not much changes. In fact, since we have a good direct model of $\mu(x)$, the residuals are small and the correction does not play a big role.</p>
<p>Let&rsquo;s now misspecify $\mu(x)$ and assume it is equal to $|x_5|$.</p>
<pre><code class="language-python">def estimate_e(df, X, model_e):
    e = model_e.fit(df[dgp.X], df['T']).predict_proba(df[dgp.X])[:,1]
    return e

def estimate_mu(df, X, model_mu):
    mu0 = 0
    mu1 = np.abs(df['x6'])
    return mu0, mu1
</code></pre>
<pre><code class="language-python">distribution_AIPW(&quot;Distribution of $\hat τ_{AIPW}$ with misspecified $\hat μ$&quot;)
</code></pre>
<p><img src="img/aipw_48_0.png" alt="png"></p>
<p>In this case, the correction term is crucial and fully offsets the bias of the original estimator.</p>
<p>The <a href="https://econml.azurewebsites.net/index.html" target="_blank" rel="noopener"><code>EconML</code></a> library offers a plug and play estimator, <code>LinearDRLearner</code>.</p>
<pre><code class="language-python">from econml.drlearner import LinearDRLearner

model = LinearDRLearner(model_propensity=logit(), model_regression=rfr())
model.fit(Y=df[dgp.Y], X=df[dgp.X], T=df[dgp.T]);
</code></pre>
<p>The model directly gives us the average treatment effect.</p>
<pre><code class="language-python">model.ate_inference(X=df[dgp.X].values, T0=0, T1=1).summary().tables[0]
</code></pre>
<table class="simpletable">
<caption>Uncertainty of Mean Point Estimate</caption>
<tr>
  <th>mean_point</th> <th>stderr_mean</th>  <th>zstat</th> <th>pvalue</th> <th>ci_mean_lower</th> <th>ci_mean_upper</th>
</tr>
<tr>
    <td>-0.087</td>      <td>0.036</td>    <td>-2.438</td>  <td>0.015</td>    <td>-0.157</td>        <td>-0.017</td>    
</tr>
</table>
<p>The estimate is statistically different from zero and the confidence interval includes the true value of $-0.05$.</p>
<h2 id="research-paper-replication">Research Paper Replication</h2>
<p>TBD</p>
<h2 id="business-case">Business Case</h2>
<p>TBD</p>
<h2 id="references">References</h2>
<ul>
<li>Original paper: <a href="https://www.cambridge.org/core/journals/political-analysis/article/abs/an-introduction-to-the-augmented-inverse-propensity-weighted-estimator/4B1B8301E46F4432C4DCC91FE20780DB" target="_blank" rel="noopener">An Introduction to the Augmented Inverse Propensity Weighted Estimator</a></li>
<li><a href="https://www.youtube.com/watch?v=IfZHUFFlsGc" target="_blank" rel="noopener">Video lecture</a> by Prof. Stefan Wager (Stanford)</li>
</ul>

          </div>
          








<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://matteocourthoud.github.io/post/aipw/&amp;text=AIPW" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://matteocourthoud.github.io/post/aipw/&amp;t=AIPW" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=AIPW&amp;body=https://matteocourthoud.github.io/post/aipw/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://matteocourthoud.github.io/post/aipw/&amp;title=AIPW" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=AIPW%20https://matteocourthoud.github.io/post/aipw/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://t.me/share/url?url=https://matteocourthoud.github.io/post/aipw/&amp;text=%7btext%7d" target="_blank" rel="noopener" class="share-btn-telegram">
          <i class="fab fa-telegram"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://matteocourthoud.github.io/"><img class="avatar mr-3 avatar-circle" src="/author/avatar_hu365eedc833ccd5578a90de7c849ec45e_385094_270x270_fill_q75_lanczos_center.jpg" alt=""></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://matteocourthoud.github.io/"></a></h5>
      
      <p class="card-text">My research fields are empirical Industrial Organization and Competition Policy. My research interests include the relationship between competition and innovation, big data, artificial intelligence, platform markets, peer to peer services.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://medium.com/@matteo.courthoud" target="_blank" rel="noopener">
        <i class="fab fa-medium"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/matteo-courthoud-7335198a/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/MatteoCourthoud/" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/matteocourthoud" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://open.spotify.com/user/1180947523" target="_blank" rel="noopener">
        <i class="fab fa-spotify"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  




        </div>
        </article>
    </main>
  </div>
</div>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  

  
  <p class="powered-by">
    
      <a href="/privacy/">Privacy Policy</a>
    
    
       &middot; 
      <a href="/terms/">Terms</a>
    
  </p>
  

  
  <p class="powered-by">
    Theme edited by Matteo Courthoud© - Want to have a similar website? <a href="https://matteocourthoud.github.io/post/website/">Guide here</a>.
  </p>
  

  
  







</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.8.4/mermaid.min.js" integrity="sha512-as1BF4+iHZ3BVO6LLDQ7zrbvTXM+c/1iZ1qII/c3c4L8Rn5tHLpFUtpaEtBNS92f+xGsCzsD7b62XP3XYap6oA==" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/julia.min.js"></script>
        
      

    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    <script src="/js/bootstrap.bundle.min.6aed84840afc03ab4d5750157f69c120.js"></script>

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.cf8ca859a9b74f8b1cd804621b13e5f1.js"></script>

    
  <script async defer src="https://buttons.github.io/buttons.js"></script>




</body>
</html>
